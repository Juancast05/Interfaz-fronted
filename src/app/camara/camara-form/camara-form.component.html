<div class="container">
  <mat-card class="camera-form-card">
    <h2 class="form-title">
      <mat-icon>{{ isEditMode ? "edit" : "add_a_photo" }}</mat-icon>
      {{ isEditMode ? "Editar Cámara" : "Registrar Nueva Cámara" }}
    </h2>

    <form [formGroup]="camaraForm" (ngSubmit)="onSubmit()">
      <mat-expansion-panel [expanded]="true" class="form-section-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>info</mat-icon>
            Información General
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Cliente Sistema</mat-label>
            <mat-select formControlName="id_cliente_sistema" required>
              <mat-option [value]="null" disabled
                >Seleccione un cliente</mat-option
              >
              <mat-option
                *ngFor="let cliente of clientesSistema"
                [value]="cliente.id_cliente_sistema"
              >
                {{ cliente.nombre }}
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="
                camaraForm.controls['id_cliente_sistema'].hasError(
                  'required'
                ) && camaraForm.controls['id_cliente_sistema'].touched
              "
              >Cliente es requerido</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Alias Cámara</mat-label>
            <input matInput formControlName="alias_camara" required />
            <mat-error
              *ngIf="
                camaraForm.controls['alias_camara'].hasError('required') &&
                camaraForm.controls['alias_camara'].touched
              "
              >Alias es requerido</mat-error
            >
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Código Cámara</mat-label>
            <input matInput formControlName="codigo_camara" required />
            <mat-error
              *ngIf="
                camaraForm.controls['codigo_camara'].hasError('required') &&
                camaraForm.controls['codigo_camara'].touched
              "
              >Código de cámara es requerido</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Dirección</mat-label>
            <input matInput formControlName="direccion" />
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Serial Cámara</mat-label>
            <input matInput formControlName="serial_camara" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Activo</mat-label>
            <mat-select formControlName="activo" required>
              <mat-option value="SI">SI</mat-option>
              <mat-option value="NO">NO</mat-option>
            </mat-select>
            <mat-error
              *ngIf="
                camaraForm.controls['activo'].hasError('required') &&
                camaraForm.controls['activo'].touched
              "
              >Este campo es requerido</mat-error
            >
          </mat-form-field>
        </div>
      </mat-expansion-panel>

      <mat-expansion-panel [expanded]="true" class="form-section-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>tune</mat-icon>
            Calibración y Rendimiento
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Fecha Calibración</mat-label>
            <input
              matInput
              [matDatepicker]="picker"
              formControlName="fecha_calibracion"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Máximo Carril</mat-label>
            <input matInput type="number" formControlName="maximocarril" />
            <mat-error
              *ngIf="
                camaraForm.controls['maximocarril'].hasError('min') &&
                camaraForm.controls['maximocarril'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Metros Referencia</mat-label>
            <input matInput type="number" formControlName="metros_referencia" />
            <mat-error
              *ngIf="
                camaraForm.controls['metros_referencia'].hasError('min') &&
                camaraForm.controls['metros_referencia'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Velocidad Máxima</mat-label>
            <input
              matInput
              type="number"
              formControlName="velocidad_maxima_camara"
            />
            <mat-error
              *ngIf="
                camaraForm.controls['velocidad_maxima_camara'].hasError(
                  'min'
                ) && camaraForm.controls['velocidad_maxima_camara'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Tolerancia Permitida</mat-label>
            <input
              matInput
              type="number"
              formControlName="tolerancia_permitida"
            />
            <mat-error
              *ngIf="
                camaraForm.controls['tolerancia_permitida'].hasError('min') &&
                camaraForm.controls['tolerancia_permitida'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Resolución Cámara</mat-label>
            <input matInput formControlName="resolucion_camara" />
          </mat-form-field>
        </div>
      </mat-expansion-panel>

      <mat-expansion-panel [expanded]="false" class="form-section-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>code</mat-icon>
            Códigos y Geoubicación
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Tipo Proveedor</mat-label>
            <input
              matInput
              type="number"
              formControlName="id_tipo_proveedor_camara"
            />
            <mat-error
              *ngIf="
                camaraForm.controls['id_tipo_proveedor_camara'].hasError(
                  'min'
                ) && camaraForm.controls['id_tipo_proveedor_camara'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Tipo Cámara</mat-label>
            <input matInput type="number" formControlName="id_tipo_camara" />
            <mat-error
              *ngIf="
                camaraForm.controls['id_tipo_camara'].hasError('min') &&
                camaraForm.controls['id_tipo_camara'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Tipo Tecnología</mat-label>
            <input
              matInput
              type="number"
              formControlName="id_tipo_tecnologia"
            />
            <mat-error
              *ngIf="
                camaraForm.controls['id_tipo_tecnologia'].hasError('min') &&
                camaraForm.controls['id_tipo_tecnologia'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Index Code Proveedor</mat-label>
            <input matInput formControlName="index_code_proveedor" />
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Código Equipo</mat-label>
            <input matInput formControlName="codigo_equipo" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Latitud</mat-label>
            <input matInput formControlName="latitud" />
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Longitud</mat-label>
            <input matInput formControlName="longitud" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Punto Referencia Inicial</mat-label>
            <input matInput formControlName="punto_Referencia_inicial" />
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>Punto Referencia Final</mat-label>
            <input matInput formControlName="punto_Referencia_final" />
          </mat-form-field>
        </div>
      </mat-expansion-panel>

      <mat-expansion-panel [expanded]="false" class="form-section-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>person</mat-icon>
            Información de Usuario
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Usuario Registra</mat-label>
            <input
              matInput
              type="number"
              formControlName="id_usuario_registra"
            />
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Usuario Modifica</mat-label>
            <input
              matInput
              type="number"
              formControlName="id_usuario_modifica"
            />
          </mat-form-field>
        </div>
        <div class="form-row">
          <mat-form-field appearance="fill" class="form-field">
            <mat-label>ID Tipo Fuente Evidencia</mat-label>
            <input
              matInput
              type="number"
              formControlName="id_tipo_fuente_evidencia"
            />
            <mat-error
              *ngIf="
                camaraForm.controls['id_tipo_fuente_evidencia'].hasError(
                  'min'
                ) && camaraForm.controls['id_tipo_fuente_evidencia'].touched
              "
              >Valor no puede ser negativo</mat-error
            >
          </mat-form-field>
        </div>
      </mat-expansion-panel>

      <div class="form-actions">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="camaraForm.invalid"
        >
          <mat-icon>{{ isEditMode ? "save" : "add_circle" }}</mat-icon>
          {{ isEditMode ? "Actualizar" : "Guardar" }}
        </button>
        <button mat-raised-button color="warn" type="button" (click)="cancel()">
          <mat-icon>cancel</mat-icon>
          Cancelar
        </button>
      </div>
    </form>
  </mat-card>
</div>
